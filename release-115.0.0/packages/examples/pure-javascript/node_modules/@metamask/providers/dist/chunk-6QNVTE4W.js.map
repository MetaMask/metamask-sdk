{"version":3,"sources":["../src/middleware/createRpcWarningMiddleware.ts"],"names":[],"mappings":";;;;;;;;;AAaO,SAAS,2BACd,KACwC;AACxC,QAAM,eAAe;AAAA,IACnB,uBAAuB;AAAA,IACvB,sCAAsC;AAAA,IACtC,iCAAiC;AAAA,EACnC;AAEA,SAAO,CAAC,KAAK,MAAM,SAAS;AAC1B,QAAI,CAAC,aAAa,yBAAyB,IAAI,WAAW,eAAe;AACvE,UAAI,KAAK,iBAAS,SAAS,IAAI,qBAAqB;AACpD,mBAAa,wBAAwB;AAAA,IACvC,WACE,CAAC,aAAa,wCACd,IAAI,WAAW,8BACf;AACA,UAAI,KAAK,iBAAS,SAAS,IAAI,oCAAoC;AACnE,mBAAa,uCAAuC;AAAA,IACtD,WACE,CAAC,aAAa,mCACd,IAAI,WAAW,uBACf,CAAC,QAAQ,OAAO,EAAE;AAAA,MACf,IAAyC,QAAQ,QAAQ;AAAA,IAC5D,GACA;AACA,UAAI,KAAK,iBAAS,SAAS,IAAI,+BAA+B;AAC9D,mBAAa,kCAAkC;AAAA,IACjD;AACA,SAAK;AAAA,EACP;AACF","sourcesContent":["import type { JsonRpcMiddleware } from '@metamask/json-rpc-engine';\nimport type { Json, JsonRpcParams, JsonRpcRequest } from '@metamask/utils';\n\nimport { ERC1155, ERC721 } from '../constants';\nimport messages from '../messages';\nimport type { ConsoleLike } from '../utils';\n\n/**\n * Create JSON-RPC middleware that logs warnings for deprecated RPC methods.\n *\n * @param log - The logging API to use.\n * @returns The JSON-RPC middleware.\n */\nexport function createRpcWarningMiddleware(\n  log: ConsoleLike,\n): JsonRpcMiddleware<JsonRpcParams, Json> {\n  const sentWarnings = {\n    ethDecryptDeprecation: false,\n    ethGetEncryptionPublicKeyDeprecation: false,\n    walletWatchAssetNFTExperimental: false,\n  };\n\n  return (req, _res, next) => {\n    if (!sentWarnings.ethDecryptDeprecation && req.method === 'eth_decrypt') {\n      log.warn(messages.warnings.rpc.ethDecryptDeprecation);\n      sentWarnings.ethDecryptDeprecation = true;\n    } else if (\n      !sentWarnings.ethGetEncryptionPublicKeyDeprecation &&\n      req.method === 'eth_getEncryptionPublicKey'\n    ) {\n      log.warn(messages.warnings.rpc.ethGetEncryptionPublicKeyDeprecation);\n      sentWarnings.ethGetEncryptionPublicKeyDeprecation = true;\n    } else if (\n      !sentWarnings.walletWatchAssetNFTExperimental &&\n      req.method === 'wallet_watchAsset' &&\n      [ERC721, ERC1155].includes(\n        (req as JsonRpcRequest<{ type: string }>).params?.type || '',\n      )\n    ) {\n      log.warn(messages.warnings.rpc.walletWatchAssetNFTExperimental);\n      sentWarnings.walletWatchAssetNFTExperimental = true;\n    }\n    next();\n  };\n}\n"]}